(function(){var a,b;b=this,a=b.jQuery||b.Zepto||b.ender,a.fn.spandex=function(b){var c,d,e,f,g,h,i=this;return h=function(b){return f[b]?f[b].apply(i,Array.prototype.slice.call(arguments,1)):typeof b=="string"?(f.init.apply(i),f.use.apply(i,arguments)):typeof b=="object"||!b?f.init.apply(i,arguments):a.error("argument error for jQuery.spandex")},e={image:function(a,b,c,d,e){var f,g,h,i,j,k;return a<=e.width&&(a=e.width),b<=e.height&&(b=e.height),j=c/d,a/j>b?(g=a,f=a/c*d,i=(a/j-b)/2,h=0,k=a/c):(f=b,g=b/d*c,i=0,h=(g-a)/2,k=b/d),{width:g,height:f,top:i,left:h,ratio:j,scale:k}},wrapper:function(a,b,c,d){var e,f;return f=a-(c.right+c.left),f<=d.width&&(f=d.width),e=b-(c.bottom+c.top),e<=d.height&&(e=d.height),{width:f,height:e,top:c.top,left:c.left}}},g=function(b,c,d){var f,g,h,j,k;g=d.wrapper.fullscreen?a(window).width():i.width(),f=d.wrapper.fullscreen?a(window).height():i.height(),j=e.wrapper(g,f,d.wrapper.clip,d.wrapper.min),b.css(j),h=e.image(j.width,j.height,d.image.width,d.image.height,d.image.min),k={top:0,left:0,width:h.width,height:h.height},d.image.centered.y&&(k.top="-"+h.top+"px"),d.image.centered.x&&(k.left="-"+h.left+"px");try{c.css(k)}catch(l){}return i.trigger("stretch",{wrapper:j,image:h})},d=function(b,c,d){var e;return a(c).find("div.spandex").remove(),e=a(document.createElement("div")).addClass("spandex"),e.css(d.wrapper.css),e.data("spandex",d),a(c).append(e)},c=function(b,c,d,e){var f,h,j,k,l,m;h=a(c).find("div.spandex"),m=h.data("spandex"),k=new Image,f=a(k);try{f.css(m.image.css)}catch(n){}return l=function(){var b;return h.find("img").fadeOut(m.speed,function(){return a(this).remove()}),h.append(f),m.image.width=k.width,m.image.height=k.height,m.image.src=d,h.data("spandex",m),f.fadeIn(m.speed),b=function(){return g(h,f,m)},b(),i.trigger("change",f),e&&e.apply(i,f),a(window).on("resize",b),i.one("destroy",function(){return i.unbind(".spandex"),a(window).off("resize",b),clearTimeout(h.data("spandex.timeout")),h.remove()})},j=function(){var a;return clearTimeout(h.data("spandex.timeout")),m.defer!==0?(a=setTimeout(l,m.defer),h.data("spandex.timeout",a)):l()},f.one("load",j).attr("src",d).each(function(){if(this.complete)return a(this).trigger("load")})},f={init:function(b,c,e){var f;return b==null&&(b={}),f=a.extend({speed:0,defer:0},b),f.wrapper=a.extend({fullscreen:!0},b.wrapper||(b.wrapper={})),f.wrapper.min=a.extend({width:0,height:0},b.wrapper.min||{}),f.wrapper.clip=a.extend({top:0,bottom:0,left:0,right:0},b.wrapper.clip||{}),f.wrapper.css=a.extend({left:0,top:0,position:"fixed",overflow:"hidden",zIndex:-999999,margin:0,padding:0,height:"100%",width:"100%"},b.wrapper.css||{}),f.image=a.extend({},b.image||(b.image={})),f.image.centered=a.extend({x:!0,y:!0},b.wrapper.centered||{}),f.image.min=a.extend({width:0,height:0},b.wrapper.min||{}),f.image.css=a.extend({position:"absolute",display:"none",margin:0,padding:0,border:"none",zIndex:-999999,opacity:100},b.wrapper.css||{}),this.each(function(a,b){return d(a,b,f)}),c?h("use",c,e):this},destroy:function(){return this.trigger("destroy")},stretch:function(){return this.trigger("resize")},use:function(a,b){var d=this;return this.each(function(d,e){return c(d,e,a,b)})}},h.apply(this,arguments)}}).call(this);